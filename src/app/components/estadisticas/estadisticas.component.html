<div class="estadisticas-container">
    <legend class="h3 text-center titulo-naranja d-flex align-items-center justify-content-center text-uppercase"> 
        <img src="assets/fotos/archivo-estadisticas.png" alt="Estad铆sticas" width="50" style="height: 40px;" class="me-2">
        Estad铆sticas del Ganado
    </legend>        
    <p>Analiza informaci贸n clave sobre tu ganado en tiempo real.</p>

    <ng-container *ngIf="ganado$ | async as ganado">
        <p *ngIf="ganado.length === 0" class="text-muted">No hay datos disponibles.</p>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Total de Vacas</h3>
            <p> {{ ganado.length }}</p>
        </section>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Peso Promedio</h3>
            <p>锔 {{ calcularPesoPromedio(ganado) }} kg</p>
        </section>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Ganado por Prop贸sito</h3>
            <ul role="list">
                <li role="listitem">Engorde: {{ contarPorCategoria(ganado, 'proposito', 'Engorde') }}</li>
                <li role="listitem">Leche: {{ contarPorCategoria(ganado, 'proposito', 'Leche') }}</li>
                <li role="listitem">Reproducci贸n: {{ contarPorCategoria(ganado, 'proposito', 'Reproducci贸n') }}</li>
                <li role="listitem">Venta: {{ contarPorCategoria(ganado, 'proposito', 'Venta') }}</li>
            </ul>
        </section>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Distribuci贸n por Sexo</h3>
            <p> Machos: {{ contarPorCategoria(ganado, 'sexo', 'Macho') }} |  Hembras: {{ contarPorCategoria(ganado, 'sexo', 'Hembra') }}</p>
        </section>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Distribuci贸n por Estado de Salud</h3>
            <ul role="list">
                <li role="listitem">Sano: {{ contarPorCategoria(ganado, 'estadoSalud', 'Sano') }}</li>
                <li role="listitem">Enfermo: {{ contarPorCategoria(ganado, 'estadoSalud', 'Enfermo') }}</li>
                <li role="listitem">En tratamiento: {{ contarPorCategoria(ganado, 'estadoSalud', 'En tratamiento') }}</li>
            </ul>
        </section>

        <section class="estadistica-card" *ngIf="ganado.length > 0">
            <h3>Valor Total del Ganado</h3>
            <p> ${{ calcularValorTotalGanado(ganado) | number:'1.0-2' }}</p>
        </section>

        <!-- Nuevo t铆tulo para la secci贸n de generaci贸n de gr谩ficos -->
        <h3 class="text-center titulo-naranja mt-4">Generaci贸n de Gr谩ficos</h3>
        <p class="text-center">Selecciona una categor铆a para visualizar los gr谩ficos.</p>

        <!-- Botones de Categor铆as -->
<div class="botones-categorias" *ngIf="ganado.length > 0">
    <button (click)="seleccionarCategoria('peso-valor')" aria-label="Ver Peso y Valor">Valores por Precio</button>
    <button (click)="seleccionarCategoria('proposito')" aria-label="Ver Prop贸sito">Valores por Peso</button>
    <button (click)="seleccionarCategoria('sexo-salud')" aria-label="Ver Sexo y Salud">Sexo y Salud</button>
    <button (click)="seleccionarCategoria('tendencias')" aria-label="Ver Proyecciones">Proyecciones</button>
</div>

<!-- Contenedor de Gr谩ficos -->
<div class="contenedor-graficos" *ngIf="ganado.length > 0 && categoriaSeleccionada">
    <div *ngIf="categoriaSeleccionada === 'peso-valor'" class="grid-graficos">
      <div class="grafico">
        <h4>Valor Total del Ganado por Prop贸sito</h4>
        <canvas #graficoValor></canvas>
      </div>
      <div class="grafico">
        <h4>Valor Total del Ganado por Peso</h4>
        <canvas #graficoPesoValor></canvas>
      </div>
    </div>
  
    <div *ngIf="categoriaSeleccionada === 'proposito'" class="grid-graficos">
      <div class="grafico">
        <h4>Edad por Peso</h4>
        <canvas #graficoEdadPeso></canvas>
      </div>
      <div class="grafico">
        <h4>Ganado por Prop贸sito</h4>
        <canvas #graficoProp></canvas>
      </div>
    </div>
  
    <div *ngIf="categoriaSeleccionada === 'sexo-salud'" class="grid-graficos">
      <div class="grafico">
        <h4>Distribuci贸n por Sexo</h4>
        <canvas #graficoSexo></canvas>
      </div>
      <div class="grafico">
        <h4>Distribuci贸n por Estado de Salud</h4>
        <canvas #graficoSalud></canvas>
      </div>
    </div>
  
    <div *ngIf="categoriaSeleccionada === 'tendencias'" class="grid-graficos">
      <div class="grafico">
        <h4>Predicci贸n de Tendencias</h4>
        
        <!-- Condicional para mostrar mensaje si no hay datos hist贸ricos -->
        <div *ngIf="mensaje" class="mensaje-mostrar">
          {{ mensaje }}
        </div>
        
        <canvas #graficoPrediccion></canvas>
      </div>
    </div>
  </div>
  